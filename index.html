<!DOCTYPE html>
<html lang='en'>
<head>
    <meta charset='UTF-8'>
    <title>One: Google simplified by hundred zeros</title>

    <!-- Mobile -->
    <meta name='viewport'
          content='width=device-width, initial-scale=1, viewport-fit=cover'>

    <!-- Bootstrap 5 -->
    <link href='https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css' rel='stylesheet'>

    <style>
        body {
            background-color: #0f0f0f;
            color: #eaeaea;
            padding-bottom: env(safe-area-inset-bottom);
        }

        .card {
            background-color: #1a1a1a;
            border: none;
        }

        .form-control {
            background-color: #121212;
            color: #ffffff;
            border: 1px solid #333;
        }

        .form-control:focus {
            background-color: #121212;
            color: #ffffff;
            border-color: #0d6efd;
            box-shadow: none;
        }

        .btn {
            min-height: 44px;
        }

        .btn-outline-primary,
        .btn-outline-secondary {
            color: #ccc;
            border-color: #444;
        }

        .btn-outline-primary:hover,
        .btn-outline-secondary:hover {
            background-color: #333;
            border-color: #666;
        }

        .btn-country.active,
        .btn-year.active {
            background-color: #0d6efd;
            border-color: #0d6efd;
            color: #fff;
        }

        .form-check-input {
            background-color: #222;
            border-color: #555;
        }

        .form-check-input:checked {
            background-color: #0d6efd;
            border-color: #0d6efd;
        }

        @media (max-width: 768px) {
            .mobile-search {
                position: sticky;
                bottom: 0;
                background-color: #111;
                padding: 12px;
                box-shadow: 0 -2px 12px rgba(0,0,0,.6);
                z-index: 1000;
            }
        }
    </style>
</head>
<body>

<div class='container py-3 py-md-5'>
    <div class='row justify-content-center'>
        <div class='col-lg-8'>

            <div class='card shadow-sm'>
                <div class='card-body'>

                    <h3 class='mb-4 text-center'>
                        Cizinec je na≈°inec
                    </h3>

                    <!-- INPUT -->
                    <div class='mb-3'>
                        <input id='queryInput'
                               type='text'
                               class='form-control form-control-lg'
                               placeholder='Enter search text...'>
                    </div>

                    <!-- COUNTRIES -->
                    <div class='mb-3'>
                        <strong>Country</strong>
                        <div id='countryButtons'
                             class='d-flex flex-wrap gap-2 mt-2'></div>
                    </div>

                    <!-- YEAR -->
                    <div class='mb-3'>
                        <strong>Year limit</strong>
                        <div class='d-flex flex-wrap gap-2 mt-2'>
                            <button class='btn btn-outline-secondary btn-year'
                                    onclick='setYear(this, 2015)'>&lt;2015</button>
                            <button class='btn btn-outline-secondary btn-year'
                                    onclick='setYear(this, 2020)'>&lt;2020</button>
                            <button class='btn btn-outline-secondary btn-year active'
                                    onclick='setYear(this, 2026)'>&lt;2026</button>
                        </div>
                    </div>

                    <!-- EXCLUDE -->
                    <div class='form-check form-switch mb-4'>
                        <input class='form-check-input'
                               type='checkbox'
                               id='excludeSocial'
                               checked>
                        <label class='form-check-label' for='excludeSocial'>
                            Exclude social media
                        </label>
                    </div>

                </div>
            </div>

            <!-- MOBILE SEARCH -->
            <div class='mobile-search d-md-none'>
                <button class='btn btn-success w-100 btn-lg'
                        onclick='runSearch()'>
                    Search
                </button>
            </div>

            <!-- DESKTOP SEARCH -->
            <div class='text-end mt-3 d-none d-md-block'>
                <button class='btn btn-success btn-lg'
                        onclick='runSearch()'>
                    Search
                </button>
            </div>

        </div>
    </div>
</div>

<script>
/* ===============================
   CONFIG
================================ */

const COUNTRY_CONFIG = {
    CZ: { lang: 'cs', gl: 'CZ' },
    SK: { lang: 'sk', gl: 'SK' },
    UA: { lang: 'uk', gl: 'UA' },
    US: { lang: 'en', gl: 'US' },
    DE: { lang: 'de', gl: 'DE' },
    AT: { lang: 'de', gl: 'AT' },
    AT: { lang: 'fr', gl: 'FR' }

}

let selectedCountry = 'CZ'
let yearLimit = 2026

/* ===============================
   INIT
================================ */

document.addEventListener('DOMContentLoaded', () => {
    createCountryButtons()
    document.getElementById('queryInput').value = 'ukrajina volby'
})

/* ===============================
   UI
================================ */

function createCountryButtons() {
    const container = document.getElementById('countryButtons')

    Object.keys(COUNTRY_CONFIG).forEach(code => {
        const btn = document.createElement('button')
        btn.className = 'btn btn-outline-primary btn-country'
        btn.innerText = code

        if (code === selectedCountry) {
            btn.classList.add('active')
        }

        btn.onclick = () => setCountry(btn, code)
        container.appendChild(btn)
    })
}

function setCountry(btn, country) {
    document.querySelectorAll('.btn-country')
        .forEach(b => b.classList.remove('active'))

    btn.classList.add('active')
    selectedCountry = country
    runSearch()
}

function setYear(btn, year) {
    document.querySelectorAll('.btn-year')
        .forEach(b => b.classList.remove('active'))

    btn.classList.add('active')
    yearLimit = year
    runSearch()
}

/* ===============================
   SEARCH
================================ */

async function runSearch() {
    const text = document.getElementById('queryInput').value.trim()
    if (!text) return

    const lang = COUNTRY_CONFIG[selectedCountry].lang

    try {
        const translated = await translateText(text, lang)
        openGoogleSearch(translated)
    } catch {
        openGoogleSearch(text)
    }
}

async function translateText(text, lang) {
    if (lang === 'cs') return text

    const url =
        'https://api.mymemory.translated.net/get' +
        '?q=' + encodeURIComponent(text) +
        '&langpair=auto|' + lang

    const response = await fetch(url)
    const data = await response.json()

    if (!data.responseData?.translatedText) {
        throw new Error('Translation failed')
    }

    return data.responseData.translatedText
}

function openGoogleSearch(queryText) {
    let query = queryText + ' before:' + yearLimit

    if (document.getElementById('excludeSocial').checked) {
        query +=
            ' -site:facebook.com' +
            ' -site:instagram.com' +
            ' -site:tiktok.com' +
            ' -site:twitter.com' +
            ' -site:x.com'
    }

    const cfg = COUNTRY_CONFIG[selectedCountry]
    const tbs = 'cdr:1,cd_max:' + yearLimit

    const url =
        'https://www.google.com/search' +
        '?q=' + encodeURIComponent(query) +
        '&hl=' + cfg.lang +
        '&gl=' + cfg.gl +
        '&tbs=' + encodeURIComponent(tbs)

    window.open(url, '_blank')
}
</script>

</body>
</html>
